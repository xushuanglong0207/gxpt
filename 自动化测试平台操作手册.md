# 自动化测试平台操作手册

## 📑 目录

1. [系统概述](#系统概述)
2. [环境配置](#环境配置)
3. [常见问题解决](#常见问题解决)
4. [后台系统启动指南](#后台系统启动指南)
5. [用户管理](#用户管理)
6. [测试任务管理](#测试任务管理)
7. [测试报告查看](#测试报告查看)
8. [系统扩展和维护](#系统扩展和维护)

## 系统概述

自动化测试平台是一个集成化的测试管理系统，提供了测试任务创建、执行、报告生成和查看等功能。主要特点包括：

- **用户管理**：多用户支持，分级权限控制
- **多模块测试**：支持API、UI、SSH等多种测试类型
- **报告生成**：自动生成详细的测试报告
- **定时任务**：支持定时执行测试任务
- **消息通知**：支持钉钉机器人通知测试结果
- **友好界面**：直观易用的Web界面

该平台支持API、UI和SSH三种测试类型及其子模块，可在不同环境(开发、测试、生产)中执行测试。

## 环境配置

### 系统要求

- Python 3.7+
- 操作系统：Windows/Linux
- 浏览器：Chrome/Firefox/Edge等现代浏览器

### 依赖安装

在使用平台前，需要安装以下依赖：

```bash
# 安装基本依赖
pip install flask flask-login werkzeug jinja2

# 安装定时任务和通知依赖
pip install schedule requests
```

也可以使用提供的安装脚本进行自动安装：

```bash
python setup_web.py
```

### 确认安装

运行以下命令检查依赖是否已正确安装：

```bash
pip list | grep flask
pip list | grep schedule
```

## 常见问题解决

### 启动问题

**问题：ModuleNotFoundError: No module named 'flask_login'**

解决方法：
1. 激活虚拟环境（如果使用）
2. 运行 `pip install flask-login`
3. 如果网络受限，可使用国内镜像源：
   ```bash
   pip install flask-login -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```
4. 运行 `python setup_web.py` 自动安装所有依赖

### 登录问题

**问题：TypeError: User.check_password() missing 1 required positional argument**

解决方法：
1. 这是由于登录验证方法调用错误导致
2. 已在最新版本中修复
3. 请确保使用最新版本的代码

### 任务执行问题

**问题：任务创建后一直显示加载状态**

解决方法：
1. 最新版本已添加加载状态提示，30秒后会显示"任务处理时间较长"的提示
2. 90秒后会提供"返回任务列表"的选项，可点击查看任务列表
3. 如果任务确实卡住，可以检查：
   - 服务器日志是否有错误信息
   - 网络连接是否正常
   - 任务执行环境是否配置正确
4. 刷新页面，在任务列表中查看任务的最新状态

**问题：定时任务未按预期执行**

解决方法：
1. 检查任务的调度设置是否正确（格式必须严格匹配）
2. 确认任务状态是"启用"而非"禁用"
3. 检查服务器时间是否正确
4. 查看日志文件`logs/scheduler.log`了解详细错误信息

## 后台系统启动指南

### 确保数据目录存在

首次启动前，确保数据目录已创建：
```
mkdir -p web_admin/data
```

### 启动Web后台

1. 命令行进入项目根目录（确保虚拟环境已激活）
2. 执行：
   ```
   python web_admin/app.py
   ```
3. 如果一切正常，终端将显示类似信息：
   ```
   * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
   ```
4. 打开浏览器，访问 `http://localhost:5000` 或 `http://127.0.0.1:5000`

### 首次登录

1. 使用默认管理员账号登录：
   - 用户名：admin
   - 密码：admin123

2. 登录后，建议立即修改默认管理员密码

## 用户管理

### 登录系统

1. 访问 `http://localhost:5000/login`
2. 输入用户名和密码
3. 点击"登录"按钮

### 添加新用户

1. 登录管理员账号
2. 从导航菜单点击"用户管理"
3. 点击"添加用户"按钮
4. 填写用户信息：
   - 用户名：必填，唯一标识
   - 密码：必填，建议使用强密码
   - 角色：选择"普通用户"或"管理员"
5. 点击"保存"按钮完成创建

### 编辑用户

1. 在用户列表中找到要编辑的用户
2. 点击对应的"编辑"按钮
3. 修改需要更新的信息
   - 密码留空表示不修改
4. 点击"保存"按钮提交更改

### 删除用户

1. 在用户列表中找到要删除的用户
2. 点击对应的"删除"按钮
3. 在确认对话框中点击"确定"

## 测试任务管理

### 创建测试任务

1. 从导航菜单点击"测试任务"
2. 点击"创建任务"按钮
3. 填写任务信息：
   - 任务名称：任务的标识名称
   - 测试模块：选择要测试的模块(API/UI/SSH)
   - 子模块：选择具体的测试子模块
   - 测试环境：选择dev/test/prod
   - 报告类型：选择HTML/JSON/Allure
   - 并行执行数：设置并发测试数量
   - 标签：添加标签以便于分类管理
4. 点击"创建任务"按钮保存

### 运行测试任务

1. 在任务列表页点击任务名称进入详情页
2. 点击"运行任务"按钮
3. 系统将在后台执行测试，页面会显示"运行中"状态
4. 测试完成后，状态会自动更新为"已完成"或"失败"

### 查看任务详情

1. 在任务列表中点击任务名称
2. 任务详情页显示：
   - 基本信息（名称、创建时间等）
   - 配置信息（模块、环境等）
   - 执行结果
   - 关联的测试报告

## 测试报告查看

### 查看报告列表

1. 从导航菜单点击"测试报告"
2. 系统显示所有报告列表
3. 可使用搜索框过滤报告

### 查看报告详情

1. 在报告列表中找到要查看的报告
2. 点击"查看"按钮
3. 系统会打开报告详情页面，显示测试结果

### 删除报告

1. 在报告列表中找到要删除的报告
2. 点击对应的"删除"按钮
3. 在确认对话框中点击"确定"

## 系统扩展和维护

### 添加新的测试模块

如需添加新的测试类型或子模块，请修改以下文件：

- `web_admin/static/js/main.js`：更新子模块选择逻辑
- `run.py`：更新模块处理逻辑

### 自定义报告样式

报告模板位于 `templates` 目录，可以根据需要修改HTML和CSS。

### 数据备份

平台数据存储在 `web_admin/data` 目录中，建议定期备份此目录。

---

如有任何问题或建议，请联系系统管理员。

祝您使用愉快！ 